<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Yi-Chao  Chen | Enhancing QRCode Security by Fingerprinting Screens</title>
    <meta name="author" content="Yi-Chao  Chen" />
    <meta name="description" content="In ScreenID, PWM frequency of screens is exploited as the unique screen fingerprint and used to enhance the security of a QR code by identifying its authenticity." />
    <meta name="keywords" content="academic-website, portfolio-website, computer-science, mobile-computing, cyber-physical-system" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://yichao0319.github.io/projects/2019_screenid/">
    
    <!-- Dark Mode -->
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://yichao0319.github.io/"><img src="/assets/img/logo-lab2.png" width="300"></a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li>
              

              <!-- Other pages -->
              <!---->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">Publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/courses/">Teaching</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/patents/">Patent</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/awards/">Awards</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/internal/">Internal</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
<div class="post">

  <h2 class="post-title" style="font-weight: bold; text-align: center; ">Enhancing QRCode Security by Fingerprinting Screens</h2>

  
  
  
  
  
  <div style="font-weight: bold; text-align: center; font-size: 16px">
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Yijie Li<sup> 1</sup>
    ,
    
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Yi-Chao Chen<sup> 1</sup>
    ,
    
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Xiaoyu Ji<sup> 2</sup>
    ,
    
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Hao Pan<sup> 1</sup>
    ,
    
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Lanqing Yang<sup> 1</sup>
    ,
    <br>
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Guangtao Xue<sup> 1</sup>
    ,
    
  <!-- check affiliations -->
    
    
    

    
    <!-- END: check affiliations -->

    Jiadi Yu<sup> 1</sup>
    
    
  
  </div>
  <div style="font-weight: normal; text-align: center; font-size: 16px">
  Shanghai Jiao Tong University<sup> 1</sup>
    <br>
  Zhejiang University<sup> 2</sup>
    
  
  </div>

  <article style="text-align: justify;">
    <h2 id="abstract">Abstract</h2>

<p>Quick response (QR) codes have been widely used in mobile applications due 
to its convenience and the pervasive built-in cameras on smartphones. 
Recently, however, attacks against QR codes have been reported that 
attackers can capture a QR code of the victim and replay it to achieve a 
fraudulent transaction or intercept private information, just before the 
original QR code is scanned.</p>

<p>In this study, we enhance the security of a QR 
code by identifying its authenticity. We propose ScreenID, which embeds 
a QR code with information of the screen which displays it, thereby the QR 
code can reveal whether it is reproduced by an adversary or not. In 
ScreenID,  PWM frequency of screens is exploited as the unique screen 
fingerprint. To improve the estimation accuracy of PWM frequency, 
ScreenID incorporates a model  for the interaction between the camera and 
screen in the temporal and spatial domains. Extensive experiments 
demonstrate that ScreenID can differentiate screens of different models, 
types, and manufacturers, thus improve the security of QR codes.</p>

<hr>

<h2 id="introduction">Introduction</h2>

<p>The QRCode system works in a straightforward way. As shown 
in the flowchart in <code class="language-plaintext highlighter-rouge">Fig.1</code>, payment transactions begin 
with the generation of a legal QR code, which includes the ID of the user in the application, e.g., the AliPay account, a time-stamp, and the secret transaction information in the form of an encrypted token. The user then presents the QR code to the cashier to have it scanned into the transaction system, together with other transaction information such as total amount and currency type. On the server side, the merchant extracts the token from QR code, obtains the user ID from the token and then accesses the database maintained by the company to retrieve the stored secret of the payer. This secret is then converted into a new token for verification. As long as the token is deemed valid, the transaction proceeds.</p>

<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/project-screenid-authentication-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/project-screenid-authentication-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/project-screenid-authentication-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/project-screenid-authentication.png">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Fig. 1 A flowchart of a typical QRCode system for mobile transaction.
</div>

<p>However, the above-mentioned transaction process is far from secure. Recently, 
researchers have reported that a QRCode system is susceptible to the 
Synchronized Token Lifting and Spending (STLS) attack and other similar 
attacks <a href="#refer-1"><sup>1</sup></a>. In this attack, the adversary first acquires an 
image of the QR code displayed on the victim’s device, when the 
victim is showing the QR code to the cashier, then the adversary replays the stolen QR code for another transaction, which we call fraudulent 
transaction. To ensure the success of such an attack, the adversary should also 
finish the transaction before the legitimate scanning process from the cashier.</p>

<p>To address this issue, we sought to enhance the security of the QRCode system by 
identifying the authenticity of a QR code. We propose ScreenID, which embeds a 
QR code with information of the screen that is displaying it, thereby the 
generated QR code can reveal whether the screen is corresponding to it. In ScreenID, we utilize the pulse width modulation (PWM) frequency of screens as the unique screen fingerprint. PWM frequency makes a good candidate for screen fingerprint for the reason that it is adjusted to 
different value by screen manufacturers. Even for the same manufacture, the PWM 
frequency shows variances due to the variations in the manufacturing processes.</p>

<p><code class="language-plaintext highlighter-rouge">Fig.2(a)(c)(e)</code> shows the black and white bands caused by 
the interaction between LCD screen flicker and the rolling shutter. Note the 
lack of variation in the width and angle of the bands despite variations in the 
distance and angle between the camera and screen. This indicates the 
estimates of flicker frequency vary only as a function of rolling shutter 
speed. By contrast, the bands in <code class="language-plaintext highlighter-rouge">Fig.2(b)(d)(f)</code> from an OLED 
screen varied in terms of width and angle, depending on the position of the 
screen. This can be attributed to the fact that each pixel in an OLED screen is 
controlled by an LED light source and the PWM cycle of each row is 
asynchronous.</p>

<div class="row justify-content-sm-center">
    <div class="col-sm-10 mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/project-screenid-photo-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/project-screenid-photo-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/project-screenid-photo-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/project-screenid-photo.png" data-zoomable="">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Fig. 2 Images of LCD and OLED screens captured using a camera. The position and direction of the screens were varied.
</div>

<p>Therefore, the key idea of ScreenID is to model the screen-camera interaction in temporal as well as spatial domain. The system needs to parse out the PWM frequency of the screen from the captured picture regardless of any rotation angle and capturing distance. <code class="language-plaintext highlighter-rouge">Fig. 3</code> illustrates the architecture of ScreenID system, comprising two parts: encoding by the sender (smartphone screen) and decoding by the receiver (camera). For decoding process, the system first captured a single image to determine QR code position, then captured a video for real-time PWM frequency extraction. The frequency extraction process includes four steps: contour extraction, multi-frame concatenation, frequency extraction and verification.</p>

<div class="row justify-content-sm-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/project-screenid-overview-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/project-screenid-overview-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/project-screenid-overview-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/project-screenid-overview.png" data-zoomable="">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Fig. 3 overview of ScreenID system.
</div>

<hr>

<h2 id="contribution">Contribution</h2>

<p>We verified the efficacy of a ScreenID prototype using 50 screens under a 
variety of camera settings and environmental conditions. The usability of the 
proposed system was also verified in experiments involving ten participants of 
various ages. We summarize the contribution as follows:</p>

<ul>
  <li>We demonstrated the feasibility of using PWM frequency of screens for 
  fingerprint, and the fingerprint can be embedded in to a QR code to check its 
  authenticity. From our dataset, $99.3\%$ pairwise frequency differences of 
  screens are larger than $0.1Hz$.</li>
  <li>
    <p>We proposed ScreenID, which incurs no additional hardware for the QRCode system and has no requirements for user behavior. ScreenID can be implemented via a simple software update.</p>
  </li>
  <li>
    <p>We proposed to model the interaction between the camera and the 
  screen in both temporal and spatial domains and achieved high estimation 
  accuracy of PWM frequency, i.e., within $0.03Hz$</p>
  </li>
  <li>We conducted exhaustive experiments and demonstrated the efficacy of the 
ScreenID system under a variety of operating conditions. The evaluation shows 
the identifiable success rate (i.e. True Positive Rate) is above $94.3\%$ and 
the wrongly accepted rate (i.e. False Positive Rate) 
against attack attempts is below $0.8\%$.</li>
</ul>

<hr>

<h2 id="demo-video">Demo Video</h2>

<!-- The video of the pattern captured by the camera on the screen with different PWM frequencies:

<div class="embed-responsive embed-responsive-16by9">
  <iframe class="embed-responsive-item" width="560" height="315"
    src="https://www.youtube.com/embed/wyPaTBDwOvI" frameborder="0"
    allowfullscreen=""></iframe>
</div> -->

<p>The video of the full presentation:</p>

<div class="embed-responsive embed-responsive-16by9">
  <iframe class="embed-responsive-item" width="560" height="315" src="https://www.youtube.com/embed/wyPaTBDwOvI" frameborder="0" allowfullscreen=""></iframe>
</div>

<hr>

<h2 id="reference">Reference</h2>

<div id="refer-1"></div>
<p>[1] <a href="https://www.usenix.org/conference/usenixsecurity17/technical-sessions/presentation/bai" target="_blank" rel="noopener noreferrer">Picking up my tab: Understanding and mitigating synchronized token lifting and spending in mobile payment</a></p>

<hr>

<h2 id="publications">Publications</h2>

<div hidden="">
<a class="citation" href="#li-infocom21">Yijie Li et al., “ScreenID: Enhancing QRCode Security by Fingerprinting Screens,” in <i>IEEE Conference on Computer Communications (INFOCOM)</i> (IEEE, 0AD), 1–10, https://doi.org/10.1109/INFOCOM42981.2021.9488859.</a>
</div>


  </article>

</div>

<ol class="bibliography"><li>
<style>
.badge {
  display: inline-block;
  color: #FFFFFF;
  background-color: #9e9e9e;
  min-width: 10px;
  padding: 3px 6px;
  font-size: 12px;
  font-weight: normal;
  line-height: 1;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  border-radius: 2px;
  margin-right: 2px;
  &:hover {
    background-color: #2698BA;
  }
}
.special {
  font-weight: bolder;
  color: #B71C1C;
}
</style>

<!-- Author -->Yijie Li, 
        <em>Yi-Chao Chen</em>, Xiaoyu Ji, Hao Pan, Lanqing Yang, Guangtao Xue, and Jiadi Yu.
<!-- Title -->
<b>
  <a href="https://www.cs.sjtu.edu.cn/~yichao/assets/publications/infocom21_li.pdf" target="_blank" rel="noopener noreferrer">ScreenID: Enhancing QRCode Security by Fingerprinting Screens</a>

</b>.
<!-- Book Title -->
IEEE <b> INFOCOM </b> 2021.
<!-- IEEE Conference on Computer Communications (INFOCOM) 2021. -->

  <br>

  <a href="https://www.cs.sjtu.edu.cn/~yichao/assets/publications/infocom21_li.pptx" class="badge" role="button" target="_blank" rel="noopener noreferrer">Slides</a>
</li></ol>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Yi-Chao  Chen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

